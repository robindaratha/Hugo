<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Fileserver LCX in Proxmox | </title><meta name=keywords content="Proxmox,How-To,Debian,Linux,LCX"><meta name=description content="Einleitung Nachfolgend ist die Installation eines Fileserver mit SMB Freigabe innerhalb einer LCX auf Debian Basis in Proxmox beschrieben.
Voraussetzungen Promox Server mit eingerichtetem Daten-Pool (z.B. ZFS) Ein Debian LXC Template Vorbereitung eines ZFS Datasets In Proxmox Shell den folgenden Befehl eingeben zur Erstellung eines ZFS Datasets: zfs create <pool name>/<dataset name> Die Kontrolle der richtigen Anlegung geht mit dem folgenden Befehl:
zfs list Installation Container Unpriviligierten Debian LXC installieren und Nesting aktivieren."><meta name=author content="Me"><link rel=canonical href=http://localhost:1313/posts/fileserver-lcx-in-proxmox/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bf5f9f73cf17311d52cedbcda82c922e91b2f566d88a85ad9f5b5a08b586bd5f.css integrity="sha256-v1+fc88XMR1SztvNqCySLpGy9WbYioWtn1taCLWGvV8=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/fileserver-lcx-in-proxmox/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Fileserver LCX in Proxmox"><meta property="og:description" content="Einleitung Nachfolgend ist die Installation eines Fileserver mit SMB Freigabe innerhalb einer LCX auf Debian Basis in Proxmox beschrieben.
Voraussetzungen Promox Server mit eingerichtetem Daten-Pool (z.B. ZFS) Ein Debian LXC Template Vorbereitung eines ZFS Datasets In Proxmox Shell den folgenden Befehl eingeben zur Erstellung eines ZFS Datasets: zfs create <pool name>/<dataset name> Die Kontrolle der richtigen Anlegung geht mit dem folgenden Befehl:
zfs list Installation Container Unpriviligierten Debian LXC installieren und Nesting aktivieren."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/fileserver-lcx-in-proxmox/"><meta property="og:image" content="http://localhost:1313/47"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-21T11:14:51+02:00"><meta property="article:modified_time" content="2023-07-21T11:14:51+02:00"><meta property="og:site_name" content="Homepage"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/47"><meta name=twitter:title content="Fileserver LCX in Proxmox"><meta name=twitter:description content="Einleitung Nachfolgend ist die Installation eines Fileserver mit SMB Freigabe innerhalb einer LCX auf Debian Basis in Proxmox beschrieben.
Voraussetzungen Promox Server mit eingerichtetem Daten-Pool (z.B. ZFS) Ein Debian LXC Template Vorbereitung eines ZFS Datasets In Proxmox Shell den folgenden Befehl eingeben zur Erstellung eines ZFS Datasets: zfs create <pool name>/<dataset name> Die Kontrolle der richtigen Anlegung geht mit dem folgenden Befehl:
zfs list Installation Container Unpriviligierten Debian LXC installieren und Nesting aktivieren."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Fileserver LCX in Proxmox","item":"http://localhost:1313/posts/fileserver-lcx-in-proxmox/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fileserver LCX in Proxmox","name":"Fileserver LCX in Proxmox","description":"Einleitung Nachfolgend ist die Installation eines Fileserver mit SMB Freigabe innerhalb einer LCX auf Debian Basis in Proxmox beschrieben.\nVoraussetzungen Promox Server mit eingerichtetem Daten-Pool (z.B. ZFS) Ein Debian LXC Template Vorbereitung eines ZFS Datasets In Proxmox Shell den folgenden Befehl eingeben zur Erstellung eines ZFS Datasets: zfs create \u0026lt;pool name\u0026gt;/\u0026lt;dataset name\u0026gt; Die Kontrolle der richtigen Anlegung geht mit dem folgenden Befehl:\nzfs list Installation Container Unpriviligierten Debian LXC installieren und Nesting aktivieren.","keywords":["Proxmox","How-To","Debian","Linux","LCX"],"articleBody":"Einleitung Nachfolgend ist die Installation eines Fileserver mit SMB Freigabe innerhalb einer LCX auf Debian Basis in Proxmox beschrieben.\nVoraussetzungen Promox Server mit eingerichtetem Daten-Pool (z.B. ZFS) Ein Debian LXC Template Vorbereitung eines ZFS Datasets In Proxmox Shell den folgenden Befehl eingeben zur Erstellung eines ZFS Datasets: zfs create / Die Kontrolle der richtigen Anlegung geht mit dem folgenden Befehl:\nzfs list Installation Container Unpriviligierten Debian LXC installieren und Nesting aktivieren. Die Standardwerte mit 512MiB RAM und 8GiB sind ausreichend. Den Container nicht automatisch starten lassen. ID des Containers vermerken In der Shell des Proxmox Hosts den folgenden Befehl mit entsprechender ID eingeben: nano /etc/pve/lxc/.conf Hier muss der Eintrag gesetzt werden:\nmp0: //,mp=/mnt/,backup=1 Nun kann der Container gestartet werden. Installation Fileserver Installation Cockpit apt update apt upgrade apt install cockpit --no-install-recommends Installation der zusätzlichen Addons für Cockpit wget https://github.com/45Drives/cockpit-file-sharing/releases/download/v3.3.4/cockpit-file-sharing_3.3.4-1focal_all.deb wget https://github.com/45Drives/cockpit-navigator/releases/download/v0.5.10/cockpit-navigator_0.5.10-1focal_all.deb wget https://github.com/45Drives/cockpit-identities/releases/download/v0.1.12/cockpit-identities_0.1.12-1focal_all.deb apt install ./*.deb #Optional root User erlauben für Anmeldung\nnano /etc/cockpit/disallowed-users //hier den Root user entfernen bzw. auskommentieren Anmeldung an Cockpit Die Anmeldung erfolgt über die IP des Containers mit dem Port “9090” Erstellung User Unter Identities können neue Benutzer und Gruppen erstellt werden. Wichtig: Für SMB Shares werden für die Benutzer zwei Passwörter benötigt. Eines für die Shell und eines für Samba. Erstellung Share Nun kann mit dem eingebundenen Mountpoint eine Freigabe für den erstellten Benutzer erstellt werden. ","wordCount":"228","inLanguage":"en","datePublished":"2023-07-21T11:14:51+02:00","dateModified":"2023-07-21T11:14:51+02:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/fileserver-lcx-in-proxmox/"},"publisher":{"@type":"Organization","name":"","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/posts/ title=Beiträge><span>Beiträge</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/about/ title=About><span>About</span></a></li><li><a href=https://daratha.net title=Startseite><span>Startseite</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=http://localhost:1313/search/ title=Suche><span>Suche</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class=post-title>Fileserver LCX in Proxmox</h1><div class=post-meta>&lt;span title='2023-07-21 11:14:51 +0200 CEST'>21 Jul 2023&lt;/span>&amp;nbsp;·&amp;nbsp;2 min&amp;nbsp;·&amp;nbsp;228 words&amp;nbsp;·&amp;nbsp;Me</div></header><div class=post-content><h1 id=einleitung>Einleitung<a hidden class=anchor aria-hidden=true href=#einleitung>#</a></h1><p>Nachfolgend ist die Installation eines Fileserver mit SMB Freigabe innerhalb einer LCX auf Debian Basis in Proxmox beschrieben.</p><h1 id=voraussetzungen>Voraussetzungen<a hidden class=anchor aria-hidden=true href=#voraussetzungen>#</a></h1><ol><li>Promox Server mit eingerichtetem Daten-Pool (z.B. ZFS)</li><li>Ein Debian LXC Template</li></ol><h2 id=vorbereitung-eines-zfs-datasets>Vorbereitung eines ZFS Datasets<a hidden class=anchor aria-hidden=true href=#vorbereitung-eines-zfs-datasets>#</a></h2><ol><li>In Proxmox Shell den folgenden Befehl eingeben zur Erstellung eines ZFS Datasets:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>zfs create &lt;pool name&gt;/&lt;dataset name&gt;
</span></span></code></pre></div><p>Die Kontrolle der richtigen Anlegung geht mit dem folgenden Befehl:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>zfs list
</span></span></code></pre></div><h1 id=installation-container>Installation Container<a hidden class=anchor aria-hidden=true href=#installation-container>#</a></h1><ol><li>Unpriviligierten Debian LXC installieren und Nesting aktivieren. Die Standardwerte mit 512MiB RAM und 8GiB sind ausreichend. Den Container nicht automatisch starten lassen.</li><li>ID des Containers vermerken</li><li>In der Shell des Proxmox Hosts den folgenden Befehl mit entsprechender ID eingeben:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nano /etc/pve/lxc/&lt;ID&gt;.conf
</span></span></code></pre></div><p>Hier muss der Eintrag gesetzt werden:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>mp0: /&lt;zfs pool name&gt;/&lt;dataset name&gt;,mp=/mnt/&lt;interner Mountpoint&gt;,backup=1
</span></span></code></pre></div><ol start=4><li>Nun kann der Container gestartet werden.</li></ol><h1 id=installation-fileserver>Installation Fileserver<a hidden class=anchor aria-hidden=true href=#installation-fileserver>#</a></h1><ol><li>Installation Cockpit</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>apt update
</span></span><span class=line><span class=cl>apt upgrade
</span></span><span class=line><span class=cl>apt install cockpit --no-install-recommends
</span></span></code></pre></div><ol start=2><li>Installation der zusätzlichen Addons für Cockpit</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>wget</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=mi>45</span><span class=n>Drives</span><span class=o>/</span><span class=n>cockpit</span><span class=o>-</span><span class=n>file</span><span class=o>-</span><span class=n>sharing</span><span class=o>/</span><span class=n>releases</span><span class=o>/</span><span class=n>download</span><span class=o>/</span><span class=n>v3</span><span class=o>.</span><span class=mf>3.4</span><span class=o>/</span><span class=n>cockpit</span><span class=o>-</span><span class=n>file</span><span class=o>-</span><span class=n>sharing_3</span><span class=o>.</span><span class=mf>3.4</span><span class=o>-</span><span class=mi>1</span><span class=n>focal_all</span><span class=o>.</span><span class=n>deb</span>
</span></span><span class=line><span class=cl><span class=n>wget</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=mi>45</span><span class=n>Drives</span><span class=o>/</span><span class=n>cockpit</span><span class=o>-</span><span class=n>navigator</span><span class=o>/</span><span class=n>releases</span><span class=o>/</span><span class=n>download</span><span class=o>/</span><span class=n>v0</span><span class=o>.</span><span class=mf>5.10</span><span class=o>/</span><span class=n>cockpit</span><span class=o>-</span><span class=n>navigator_0</span><span class=o>.</span><span class=mf>5.10</span><span class=o>-</span><span class=mi>1</span><span class=n>focal_all</span><span class=o>.</span><span class=n>deb</span>
</span></span><span class=line><span class=cl><span class=n>wget</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=mi>45</span><span class=n>Drives</span><span class=o>/</span><span class=n>cockpit</span><span class=o>-</span><span class=n>identities</span><span class=o>/</span><span class=n>releases</span><span class=o>/</span><span class=n>download</span><span class=o>/</span><span class=n>v0</span><span class=o>.</span><span class=mf>1.12</span><span class=o>/</span><span class=n>cockpit</span><span class=o>-</span><span class=n>identities_0</span><span class=o>.</span><span class=mf>1.12</span><span class=o>-</span><span class=mi>1</span><span class=n>focal_all</span><span class=o>.</span><span class=n>deb</span>
</span></span><span class=line><span class=cl><span class=n>apt</span> <span class=n>install</span> <span class=o>./*.</span><span class=n>deb</span>
</span></span></code></pre></div><p>#Optional root User erlauben für Anmeldung</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nano /etc/cockpit/disallowed-users
</span></span><span class=line><span class=cl>//hier den Root user entfernen bzw. auskommentieren
</span></span></code></pre></div><ol start=3><li>Anmeldung an Cockpit
Die Anmeldung erfolgt über die IP des Containers mit dem Port &ldquo;9090&rdquo;</li><li>Erstellung User
Unter Identities können neue Benutzer und Gruppen erstellt werden. Wichtig: Für SMB Shares werden für die Benutzer zwei Passwörter benötigt. Eines für die Shell und eines für Samba.
<img loading=lazy src=/images/cockpit-user-creation.png alt="Cockpit User creation"></li><li>Erstellung Share
Nun kann mit dem eingebundenen Mountpoint eine Freigabe für den erstellten Benutzer erstellt werden.</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/proxmox/>Proxmox</a></li><li><a href=http://localhost:1313/tags/how-to/>How-To</a></li><li><a href=http://localhost:1313/tags/debian/>Debian</a></li><li><a href=http://localhost:1313/tags/linux/>Linux</a></li><li><a href=http://localhost:1313/tags/lcx/>LCX</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/wmi-berechtigungen-via-powershell/><span class=title>« Prev</span><br><span>WMI Berechtigungen via Powershell</span>
</a><a class=next href=http://localhost:1313/posts/chrome-installieren-via-powershell/><span class=title>Next »</span><br><span>Chrome installieren via PowerShell</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/></a></span><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>